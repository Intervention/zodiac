<?php

declare(strict_types=1);

namespace Intervention\Zodiac\Chinese;

use Intervention\Zodiac\Exceptions\RuntimeException;
use Intervention\Zodiac\Chinese\Signs\Dog;
use Intervention\Zodiac\Chinese\Signs\Dragon;
use Intervention\Zodiac\Chinese\Signs\Goat;
use Intervention\Zodiac\Chinese\Signs\Horse;
use Intervention\Zodiac\Chinese\Signs\Monkey;
use Intervention\Zodiac\Chinese\Signs\Ox;
use Intervention\Zodiac\Chinese\Signs\Pig;
use Intervention\Zodiac\Chinese\Signs\Rabbit;
use Intervention\Zodiac\Chinese\Signs\Rat;
use Intervention\Zodiac\Chinese\Signs\Rooster;
use Intervention\Zodiac\Chinese\Signs\Snake;
use Intervention\Zodiac\Chinese\Signs\Tiger;

class NewYearCalculator
{
    /**
     * Static data table of chinese new years days
     *
     * @var array<int, array{int, int, string}> $table
     */
    private static array $table = [
        1900 => [1, 31, Rat::class],
        1901 => [2, 19, Ox::class],
        1902 => [2, 8, Tiger::class],
        1903 => [1, 29, Rabbit::class],
        1904 => [2, 16, Dragon::class],
        1905 => [2, 4, Snake::class],
        1906 => [1, 25, Horse::class],
        1907 => [2, 13, Goat::class],
        1908 => [2, 2, Monkey::class],
        1909 => [1, 22, Rooster::class],
        1910 => [2, 10, Dog::class],
        1911 => [1, 30, Pig::class],
        1912 => [2, 18, Rat::class],
        1913 => [2, 6, Ox::class],
        1914 => [1, 26, Tiger::class],
        1915 => [2, 14, Rabbit::class],
        1916 => [2, 3, Dragon::class],
        1917 => [1, 23, Snake::class],
        1918 => [2, 11, Horse::class],
        1919 => [2, 1, Goat::class],
        1920 => [2, 20, Monkey::class],
        1921 => [2, 8, Rooster::class],
        1922 => [1, 28, Dog::class],
        1923 => [2, 16, Pig::class],
        1924 => [2, 5, Rat::class],
        1925 => [1, 24, Ox::class],
        1926 => [2, 13, Tiger::class],
        1927 => [2, 2, Rabbit::class],
        1928 => [1, 23, Dragon::class],
        1929 => [2, 10, Snake::class],
        1930 => [1, 30, Horse::class],
        1931 => [2, 17, Goat::class],
        1932 => [2, 6, Monkey::class],
        1933 => [1, 26, Rooster::class],
        1934 => [2, 14, Dog::class],
        1935 => [2, 4, Pig::class],
        1936 => [1, 24, Rat::class],
        1937 => [2, 11, Ox::class],
        1938 => [1, 31, Tiger::class],
        1939 => [2, 19, Rabbit::class],
        1940 => [2, 8, Dragon::class],
        1941 => [1, 27, Snake::class],
        1942 => [2, 15, Horse::class],
        1943 => [2, 5, Goat::class],
        1944 => [1, 25, Monkey::class],
        1945 => [2, 13, Rooster::class],
        1946 => [2, 2, Dog::class],
        1947 => [1, 22, Pig::class],
        1948 => [2, 10, Rat::class],
        1949 => [1, 29, Ox::class],
        1950 => [2, 17, Tiger::class],
        1951 => [2, 6, Rabbit::class],
        1952 => [1, 27, Dragon::class],
        1953 => [2, 14, Snake::class],
        1954 => [2, 3, Horse::class],
        1955 => [1, 24, Goat::class],
        1956 => [2, 12, Monkey::class],
        1957 => [1, 31, Rooster::class],
        1958 => [2, 18, Dog::class],
        1959 => [2, 8, Pig::class],
        1960 => [1, 28, Rat::class],
        1961 => [2, 15, Ox::class],
        1962 => [2, 5, Tiger::class],
        1963 => [1, 25, Rabbit::class],
        1964 => [2, 13, Dragon::class],
        1965 => [2, 2, Snake::class],
        1966 => [1, 21, Horse::class],
        1967 => [2, 9, Goat::class],
        1968 => [1, 30, Monkey::class],
        1969 => [2, 17, Rooster::class],
        1970 => [2, 6, Dog::class],
        1971 => [1, 27, Pig::class],
        1972 => [2, 15, Rat::class],
        1973 => [2, 3, Ox::class],
        1974 => [1, 23, Tiger::class],
        1975 => [2, 11, Rabbit::class],
        1976 => [1, 31, Dragon::class],
        1977 => [2, 18, Snake::class],
        1978 => [2, 7, Horse::class],
        1979 => [1, 28, Goat::class],
        1980 => [2, 16, Monkey::class],
        1981 => [2, 5, Rooster::class],
        1982 => [1, 25, Dog::class],
        1983 => [2, 13, Pig::class],
        1984 => [2, 2, Rat::class],
        1985 => [2, 20, Ox::class],
        1986 => [2, 9, Tiger::class],
        1987 => [1, 29, Rabbit::class],
        1988 => [2, 17, Dragon::class],
        1989 => [2, 6, Snake::class],
        1990 => [1, 27, Horse::class],
        1991 => [2, 15, Goat::class],
        1992 => [2, 4, Monkey::class],
        1993 => [1, 23, Rooster::class],
        1994 => [2, 10, Dog::class],
        1995 => [1, 31, Pig::class],
        1996 => [2, 19, Rat::class],
        1997 => [2, 7, Ox::class],
        1998 => [1, 28, Tiger::class],
        1999 => [2, 16, Rabbit::class],
        2000 => [2, 5, Dragon::class],
        2001 => [1, 24, Snake::class],
        2002 => [2, 12, Horse::class],
        2003 => [2, 1, Goat::class],
        2004 => [1, 22, Monkey::class],
        2005 => [2, 9, Rooster::class],
        2006 => [1, 29, Dog::class],
        2007 => [2, 18, Pig::class],
        2008 => [2, 7, Rat::class],
        2009 => [1, 26, Ox::class],
        2010 => [2, 14, Tiger::class],
        2011 => [2, 3, Rabbit::class],
        2012 => [1, 23, Dragon::class],
        2013 => [2, 10, Snake::class],
        2014 => [1, 31, Horse::class],
        2015 => [2, 19, Goat::class],
        2016 => [2, 8, Monkey::class],
        2017 => [1, 28, Rooster::class],
        2018 => [2, 16, Dog::class],
        2019 => [2, 5, Pig::class],
        2020 => [1, 25, Rat::class],
        2021 => [2, 12, Ox::class],
        2022 => [2, 1, Tiger::class],
        2023 => [1, 22, Rabbit::class],
        2024 => [2, 10, Dragon::class],
        2025 => [1, 29, Snake::class],
        2026 => [2, 17, Horse::class],
        2027 => [2, 6, Goat::class],
        2028 => [1, 26, Monkey::class],
        2029 => [2, 13, Rooster::class],
        2030 => [2, 3, Dog::class],
        2031 => [1, 23, Pig::class],
        2032 => [2, 11, Rat::class],
        2033 => [1, 31, Ox::class],
        2034 => [2, 19, Tiger::class],
        2035 => [2, 8, Rabbit::class],
        2036 => [1, 28, Dragon::class],
        2037 => [2, 15, Snake::class],
        2038 => [2, 4, Horse::class],
        2039 => [1, 24, Goat::class],
        2040 => [2, 12, Monkey::class],
        2041 => [2, 1, Rooster::class],
        2042 => [1, 22, Dog::class],
        2043 => [2, 10, Pig::class],
        2044 => [1, 30, Rat::class],
        2045 => [2, 17, Ox::class],
        2046 => [2, 6, Tiger::class],
        2047 => [1, 26, Rabbit::class],
        2048 => [2, 14, Dragon::class],
        2049 => [2, 2, Snake::class],
        2050 => [1, 23, Horse::class],
        2051 => [2, 11, Goat::class],
        2052 => [2, 1, Monkey::class],
        2053 => [2, 19, Rooster::class],
        2054 => [2, 8, Dog::class],
        2055 => [1, 28, Pig::class],
        2056 => [2, 15, Rat::class],
        2057 => [2, 4, Ox::class],
        2058 => [1, 24, Tiger::class],
        2059 => [2, 12, Rabbit::class],
        2060 => [2, 2, Dragon::class],
        2061 => [1, 21, Snake::class],
        2062 => [2, 9, Horse::class],
        2063 => [1, 29, Goat::class],
        2064 => [2, 17, Monkey::class],
        2065 => [2, 5, Rooster::class],
        2066 => [1, 26, Dog::class],
        2067 => [2, 14, Pig::class],
        2068 => [2, 3, Rat::class],
        2069 => [1, 23, Ox::class],
        2070 => [2, 11, Tiger::class],
        2071 => [1, 31, Rabbit::class],
        2072 => [2, 19, Dragon::class],
        2073 => [2, 7, Snake::class],
        2074 => [1, 27, Horse::class],
        2075 => [2, 15, Goat::class],
        2076 => [2, 5, Monkey::class],
        2077 => [1, 24, Rooster::class],
        2078 => [2, 12, Dog::class],
        2079 => [2, 2, Pig::class],
        2080 => [1, 22, Rat::class],
        2081 => [2, 9, Ox::class],
        2082 => [1, 29, Tiger::class],
        2083 => [2, 17, Rabbit::class],
        2084 => [2, 6, Dragon::class],
        2085 => [1, 26, Snake::class],
        2086 => [2, 14, Horse::class],
        2087 => [2, 3, Goat::class],
        2088 => [1, 24, Monkey::class],
        2089 => [2, 10, Rooster::class],
        2090 => [1, 30, Dog::class],
        2091 => [2, 18, Pig::class],
        2092 => [2, 7, Rat::class],
        2093 => [1, 27, Ox::class],
        2094 => [2, 15, Tiger::class],
        2095 => [2, 5, Rabbit::class],
        2096 => [1, 25, Dragon::class],
        2097 => [2, 12, Snake::class],
        2098 => [2, 1, Horse::class],
        2099 => [1, 21, Goat::class],
        2100 => [2, 9, Monkey::class],
    ];

    /**
     * Get chinese new years day of given year
     */
    public static function newYear(int $year): NewYear
    {
        if (!array_key_exists($year, self::$table)) {
            throw new RuntimeException("Missing data for " . $year . " in new year's data table");
        }

        return new NewYear($year, ...self::$table[$year]);
    }
}
